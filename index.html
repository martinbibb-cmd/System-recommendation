<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>System recommendation 2.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root {
    --bg: #000;
    --panel: #0f1115;
    --line: #1d2026;
    --text: #e7ecff;
    --muted: #91a2c7;
    --accent: #33a1ff;
    --radius: 14px;
  }
  body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  }
  #app {
    display: flex;
    height: 100vh;
    gap: 0;
  }
  /* sidebar */
  .sidebar {
    width: 280px;
    background: #050608;
    border-right: 1px solid #0c0d11;
    padding: 16px 14px;
    overflow-y: auto;
  }
  .sidebar h2 {
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: .04em;
    margin: 16px 0 6px;
    color: var(--muted);
  }
  .inputGroup {
    margin-bottom: 10px;
  }
  .inputGroup label {
    display: block;
    font-size: 12px;
    margin-bottom: 4px;
  }
  .inputGroup select,
  .inputGroup input {
    width: 100%;
    background: #0f1115;
    border: 1px solid #1d2026;
    border-radius: 9px;
    padding: 5px 6px;
    color: var(--text);
    font-size: 13px;
  }

  /* main area */
  .main {
    flex: 1;
    padding: 18px 20px 14px;
    display: flex;
    flex-direction: column;
    gap: 14px;
  }
  .title {
    font-size: 26px;
    font-weight: 600;
    margin-bottom: 2px;
  }
  .panels {
    display: grid;
    grid-template-columns: repeat(2, minmax(280px, 1fr));
    gap: 12px;
    min-height: 200px;
  }
  .panel {
    background: var(--panel);
    border: 1px solid #181b21;
    border-radius: var(--radius);
    padding: 10px 12px 12px;
    display: flex;
    flex-direction: column;
  }
  .panel h3 {
    font-size: 14px;
    margin: 0 0 4px;
  }
  .panel small {
    color: var(--muted);
    font-size: 12px;
  }
  .panel ul {
    margin: 6px 0 0 16px;
    padding: 0;
    font-size: 12.5px;
  }
  .score {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 6px;
  }
  .summary {
    background: var(--panel);
    border: 1px solid #181b21;
    border-radius: var(--radius);
    padding: 10px 12px 12px;
    min-height: 140px;
    white-space: pre-wrap;
    font-size: 12.5px;
  }
  .tag {
    display: inline-block;
    background: rgba(51,161,255,0.12);
    border: 1px solid rgba(51,161,255,0.25);
    border-radius: 999px;
    padding: 1px 8px 2px;
    font-size: 11px;
    margin-right: 4px;
  }
</style>
</head>
<body>
<div id="app">
  <aside class="sidebar">
    <h2>About you</h2>
    <div class="inputGroup">
      <label for="currentSystem">Current system</label>
      <select id="currentSystem">
        <option value="open_vented_regular">Regular + open vented cylinder</option>
        <option value="sealed_system">System boiler + unvented</option>
        <option value="combi">Combi</option>
        <option value="back_boiler">Back boiler / unknown</option>
      </select>
    </div>
    <div class="inputGroup">
      <label for="occupants">Occupants</label>
      <input id="occupants" type="number" min="1" value="3">
    </div>
    <div class="inputGroup">
      <label for="bathrooms">Bathrooms / showers</label>
      <input id="bathrooms" type="number" min="1" value="1">
    </div>
    <div class="inputGroup">
      <label for="waterPressure">Water pressure</label>
      <select id="waterPressure">
        <option value="poor">Poor / tank-fed / low mains</option>
        <option value="ok" selected>Average</option>
        <option value="good">Good mains pressure</option>
      </select>
    </div>
    <div class="inputGroup">
      <label for="pipeScreed">Pipework in screed / hard to access</label>
      <select id="pipeScreed">
        <option value="no" selected>No</option>
        <option value="yes">Yes</option>
      </select>
    </div>
    <div class="inputGroup">
      <label for="propertyType">Property type</label>
      <select id="propertyType">
        <option value="house" selected>House</option>
        <option value="flat">Flat / apartment</option>
        <option value="bungalow">Bungalow / chalet</option>
      </select>
    </div>
  </aside>
  <main class="main">
    <div class="title">Which system is best for you?</div>
    <div class="panels">
      <div class="panel" id="bestPanel">
        <h3>Best choice</h3>
        <div class="score" id="bestScore"></div>
        <div id="bestTags"></div>
        <ul id="bestPoints"></ul>
      </div>
      <div class="panel" id="secondPanel">
        <h3>Second choice</h3>
        <div class="score" id="secondScore"></div>
        <div id="secondTags"></div>
        <ul id="secondPoints"></ul>
      </div>
    </div>
    <div class="summary" id="summaryBox"></div>
  </main>
</div>

<script>
// base system definitions
const SYSTEMS = {
  combi: {
    name: "Combi boiler",
    base: 0.9
  },
  system_unvented: {
    name: "System boiler + unvented / mains pressure cylinder",
    base: 1.0
  },
  regular_open: {
    name: "Regular boiler + open vented cylinder",
    base: 0.85
  }
};

function calculateScores(input) {
  const scores = {
    combi: SYSTEMS.combi.base,
    system_unvented: SYSTEMS.system_unvented.base,
    regular_open: SYSTEMS.regular_open.base
  };

  // occupancy / bathrooms
  if (input.occupants <= 2 && input.bathrooms === 1) {
    scores.combi += 0.25; // suits small houses
  }
  if (input.occupants >= 3 || input.bathrooms >= 2) {
    scores.system_unvented += 0.35; // cylinder better
    scores.combi -= 0.25; // combi struggles
  }

  // water pressure
  if (input.waterPressure === 'good') {
    scores.combi += 0.15;
    scores.system_unvented += 0.05;
  } else if (input.waterPressure === 'poor') {
    scores.combi -= 0.5;
    scores.system_unvented -= 0.15;
    scores.regular_open += 0.25; // stored gravity often simplest
  }

  // current system
  if (input.currentSystem === 'open_vented_regular') {
    scores.regular_open += 0.15; // least disruption
  }

  // pipework in screed: pressurising is risky
  if (input.pipeScreed === 'yes') {
    scores.regular_open += 0.15;
    scores.combi -= 0.1;
    scores.system_unvented -= 0.1;
  }

  // property type
  if (input.propertyType === 'flat') {
    scores.combi += 0.15; // space
    scores.regular_open -= 0.1;
  }

  return scores;
}

function buildPointsFor(systemKey, input, isPrimary) {
  const pts = [];
  // common
  if (systemKey === 'combi') {
    pts.push("On-demand hot water – no cylinder.");
    pts.push("Designed for **one tap/shower at a time**; flow drops if 2+ outlets run.");
    pts.push("Will usually need a bigger gas supply than a 15 kW regular.");
    pts.push("Sealed/high-pressure system – converting from open vent can show leaks.");
    if (input.waterPressure !== 'good') {
      pts.push("Mains is not strong; performance will follow incoming pressure/temp.");
    }
  } else if (systemKey === 'system_unvented') {
    pts.push("Mains-pressure hot water – compatible with modern showers.");
    pts.push("Holds efficiency near ≈94% in real use (boiler can condense longer).");
    pts.push("Cylinder kept → future heat pump / PV + immersion ready.");
    pts.push("Sealed/high-pressure system – old open-vented pipework may weep.");
  } else if (systemKey === 'regular_open') {
    pts.push("Keeps system open vented → low pressure, gentle on old pipework.");
    pts.push("Usually simplest if existing cylinder is serviceable.");
    pts.push("Can add immersion for back-up.");
    if (input.waterPressure === 'poor') {
      pts.push("Best match for current low pressure / tank-fed home.");
    }
  }

  // explicit leak warning: open vent -> sealed
  const movingFromOpenVented = (input.currentSystem === 'open_vented_regular');
  const targetIsSealed = (systemKey === 'combi' || systemKey === 'system_unvented');
  if (movingFromOpenVented && targetIsSealed) {
    pts.push("⚠️ Changing from open vented to sealed can expose existing minor leaks/weeps.");
  }

  // shower compatibility note
  if (systemKey === 'combi' && input.waterPressure === 'good') {
    pts.push("Good mains = combi will run a quality shower (single outlet).");
  }
  if (systemKey === 'system_unvented') {
    pts.push("Multiple showers/bathrooms supported better than combi.");
  }

  // occupancy note
  if (systemKey === 'combi' && (input.occupants >= 3 || input.bathrooms >= 2)) {
    pts.push("Household demand is high – consider stored hot water.");
  }

  return pts;
}

function buildSummary(primaryKey, secondaryKey, input) {
  const parts = [];

  const name1 = SYSTEMS[primaryKey].name;
  const name2 = SYSTEMS[secondaryKey].name;

  parts.push(`Primary recommendation: ${name1}`);
  parts.push(`Secondary option: ${name2}`);
  parts.push('');

  // primary pros / cons
  parts.push('Primary – pros:');
  buildPointsFor(primaryKey, input, true).forEach(p => parts.push('• ' + p));

  parts.push('');
  parts.push('Primary – considerations:');
  if (primaryKey === 'combi') {
    parts.push('• Performance follows mains pressure and winter temp.');
    parts.push('• 1 hot outlet at a time is best.');
  }
  if (primaryKey === 'system_unvented') {
    parts.push('• Needs space for cylinder and discharge.');
  }
  if (primaryKey === 'regular_open') {
    parts.push('• Less future-proof for heat pumps unless cylinder is upgraded later.');
  }

  parts.push('');
  parts.push('Secondary – why it still works:');
  buildPointsFor(secondaryKey, input, false).forEach(p => parts.push('• ' + p));

  return parts.join('\n');
}

function render() {
  const input = {
    currentSystem: document.getElementById('currentSystem').value,
    occupants: parseInt(document.getElementById('occupants').value || '1', 10),
    bathrooms: parseInt(document.getElementById('bathrooms').value || '1', 10),
    waterPressure: document.getElementById('waterPressure').value,
    pipeScreed: document.getElementById('pipeScreed').value,
    propertyType: document.getElementById('propertyType').value
  };

  const scores = calculateScores(input);
  const sorted = Object.keys(scores).sort((a,b) => scores[b] - scores[a]);
  const best = sorted[0];
  const second = sorted[1];

  // best panel
  document.getElementById('bestPanel').querySelector('h3').textContent = SYSTEMS[best].name;
  document.getElementById('bestScore').textContent = 'Score: ' + scores[best].toFixed(2);
  const bestTags = document.getElementById('bestTags');
  bestTags.innerHTML = '';
  if (best === 'combi') {
    bestTags.innerHTML += '<span class="tag">Space saving</span>';
  }
  if (best === 'system_unvented') {
    bestTags.innerHTML += '<span class="tag">High flow</span><span class="tag">Future-ready</span>';
  }
  if (best === 'regular_open') {
    bestTags.innerHTML += '<span class="tag">Low disruption</span>';
  }
  const bestPoints = document.getElementById('bestPoints');
  bestPoints.innerHTML = '';
  buildPointsFor(best, input, true).forEach(p => {
    const li = document.createElement('li');
    li.innerHTML = p;
    bestPoints.appendChild(li);
  });

  // second panel
  document.getElementById('secondPanel').querySelector('h3').textContent = SYSTEMS[second].name;
  document.getElementById('secondScore').textContent = 'Score: ' + scores[second].toFixed(2);
  const secondTags = document.getElementById('secondTags');
  secondTags.innerHTML = '';
  if (second === 'system_unvented') secondTags.innerHTML += '<span class="tag">High flow</span>';
  if (second === 'combi') secondTags.innerHTML += '<span class="tag">Compact</span>';
  if (second === 'regular_open') secondTags.innerHTML += '<span class="tag">Keeps vented</span>';
  const secondPoints = document.getElementById('secondPoints');
  secondPoints.innerHTML = '';
  buildPointsFor(second, input, false).forEach(p => {
    const li = document.createElement('li');
    li.innerHTML = p;
    secondPoints.appendChild(li);
  });

  // summary
  document.getElementById('summaryBox').textContent = buildSummary(best, second, input);
}

// hook up events
['currentSystem','occupants','bathrooms','waterPressure','pipeScreed','propertyType']
  .forEach(id => {
    document.getElementById(id).addEventListener('change', render);
    document.getElementById(id).addEventListener('input', render);
  });

// initial
render();
</script>
</body>
</html>
